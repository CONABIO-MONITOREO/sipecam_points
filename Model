// Creating tables
Table Users as U {
  id int [pk, increment] // auto-increment
	username varchar
	password varchar 
	last_login timestampt
	first_name varchar 
	last_name varchar
	email varchar 
	is_active boolean 
  institution_id int
  created_at timestamp
}

Table Role_to_User {
  user_id int
  role_id int
  created_at datetime
}


Table Nodes as N {
  id int [pk, increment] // auto-increment
  //ID humano que Pedro usa para identificar 2_14_0_683
  nomenclatura varchar  
  con_socio int
  fid int
  location point
	cat_itegr varchar // Es una integridad para modulo
	cumulus_id int
	ecosystem_id int
  created_at timestamp
}

Table Institutions as I {
  id int [pk, increment] // auto-increment
   name varchar
   address varchar
   phone_number int
     created_at timestamp
   
}

Table Ecosystems as E {
  id int [pk, increment] // auto-increment
  name varchar [not null, unique]
  
}

Table Cumulus as C {
  id int [pk, increment] // auto-increment
  name varchar
  geometry polygon
  ecosystem_id int
  con_socio int
  criteria_id id
  created_at timestamp
}

Table Cumulus_criteria as CC {
  id int [pk, increment] // auto-increment
  name varchar
  created_at timestamp
}


Table Visits as V {
  id int [pk, increment] // auto-increment
  user_id int
  calendar_id int
  comments varchar
  date_started_pristine Date
  date_finished_pristine Date
  date_started_disturbed Date
  date_finished_disturbed Date
  cumulus_id int
  pristine_id int
  disturbed_id int
}



// Posibles Roles
// Socio
// Admin
// 
Table Roles as R {
  id int [pk, increment] // auto-increment
  name varchar
  description varchar
}



Table Physical_Devices as D {
  id int [pk, increment] // auto-increment
  serial_number varchar
  comments varchar
  device_id int
  cumulus_id int
  created_at timestamp
}

Table Devices_Catalog as DC {
  id int [pk, increment] // auto-
  brand varchar
  type varchar
}

Table Calendar as Cal {
  id int [pk, increment] // auto-increment
  date_started date
  date_finished date
  created_at timestamp
  sipecam_year varchar
  order int
}



Table Deployments as Dep {
  id int [pk, increment] // auto-increment
  date_started date
  date_finished date
  latitude float8
  longitude float8
  altitude float8
  comments varchar
  device_id int
  visit_id int
  created_at timestamp
}

Table PartnersCumulus as Pacu {
  id int [pk, increment] // auto-increment
  user_id int
  cumulus_id int
}

// Establecer Relaciones
// Un cumuluo muchos monitores
Table Monitors as Mon {
 id int [pk, increment] // auto-increment
 deployments_id int
 cumulus_id int
 first_name varchar
 last_name varchar
 second_last_name varchar
 contact varchar
}

Table MonitorsDeployment {
 id int [pk, increment]
 monitor_id int
 deployment_id int
}

// Relaciones uno a uno
Ref: V.(calendar_id) - Cal.(id)

// Relaciones Muchos a Uno
Ref: N.(cumulus_id) > C.(id)
Ref: D.(device_id) > DC.id
Ref: N.(ecosystem_id) > E.(id)
Ref: C.(criteria_id) > CC.(id)

// Relaciones Uno a Muchos
Ref: Pacu.(user_id) < U.(id)
Ref: Pacu.(cumulus_id) < C.(id)
Ref: V.(user_id) < U.(id)
Ref: I.(id) < U.(institution_id)
Ref: C.(id) < Mon.(cumulus_id)
Ref: C.(id) < V.(cumulus_id)
Ref: C.(id) < D.(cumulus_id)


Ref: "MonitorsDeployment"."monitor_id" < "Monitors"."id"

Ref: "MonitorsDeployment"."deployment_id" < "Deployments"."id"

Ref: "Visits"."id" < "Deployments"."visit_id"

Ref: "Physical_Devices"."id" < "Deployments"."device_id"



Ref: "Role_to_User"."user_id" < "Users"."id"

Ref: "Role_to_User"."role_id" < "Roles"."id"

Ref: "Nodes"."id" < "Visits"."pristine_id"

Ref: "Nodes"."id" < "Visits"."disturbed_id"

Ref: "Ecosystems"."id" < "Cumulus"."ecosystem_id"
